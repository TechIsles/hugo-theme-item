{{ $name := .name }}
{{ $basis := .basis | default "categories" }}

{{ $pages := where site.RegularPages (printf ".Params.%s" $basis) "intersect" (slice $name) }}
{{ range $pages }}
    <div class="nav-item h-24 card card-compact border-2 border-base-content/5 dark:border-neutral transition-all duration-200 hover:shadow hover:-translate-y-1"
         data-id="{{ $name | urlize }}">
        {{ $desc := or .Description .Summary }}
        {{ if and $desc (ne $desc "") }}
            <div class="nav-item-behind absolute card-body rounded-box p-4 inset-0 glass z-20">
                <div class="flex w-full h-full flex-row text-sm overflow-hidden">
                    <p>{{ $desc | safeHTML }}</p>
                </div>
            </div>
        {{ end }}

        <div class="nav-item-front flex h-full w-full p-1 sm:p-2">
            <div class="w-1/3 flex items-center justify-center ">
                <a href="{{ .Permalink }}" class="block relative">
                    <div class="avatar rounded-full w-10 h-10 sm:w-12 sm:h-12 ">
                        <!--@formatter:off-->
                    {{ partial "utils/favicon" (dict "url" .Params.link "favicon" .Params.favicon "class" "rounded-full object-contain" "alt" .Title) }}
                    <!--@formatter:on-->
                    </div>
                    {{ if (.Params.internal) }}
                        <span class="badge-xs badge absolute -right-4 py-2">站内</span>
                    {{ end }}
                </a>
            </div>

            <div class="w-2/3 flex flex-col justify-center px-2">
                <a {{ if (.Params.internal) }}href="{{ .Permalink }}" target="_self"{{ else }}href="{{ .Params.link }}" target="_blank"{{ end }} 
                   class="block">
                    <h3 class="text-lg truncate pb-1" title="{{ .Title }}">{{ .Title }}</h3>
                    {{ if site.Params.useHomePageTag }}
                        {{ with .Params.tags }}
                            <div class="flex flex-nowrap overflow-hidden max-w-full pt-1">
                                {{ range first 3 . }}
                                    {{ $tag := index site.Data.tags . }}
                                    <a class="badge badge-sm gap-1 mr-1 py-2.5 whitespace-nowrap" title="{{ . }}"
                                       href="/tags/{{ . | urlize }}">
                                        <!--@formatter:off-->
                                        {{ partial "utils/icon" (dict "name" ($tag.icon | default "lucide-tag") "class" "inline-block h-3 w-3") }}
                                        <!--@formatter:on-->
                                        {{ . }}
                                    </a>
                                {{ end }}
                            </div>
                        {{ end }}
                    {{ else }}
                        {{ if .Description }}
                            <p class="text-sm truncate">{{ .Description | truncate 100 | safeHTML }}</p>
                        {{ else }}
                            <p class="text-sm truncate">{{ .Summary | truncate 100 | safeHTML }}</p>
                        {{ end }}
                    {{ end }}
                </a>
            </div>
        </div>
    </div>
{{ end }}